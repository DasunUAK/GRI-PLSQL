SELECT T0.CATALOG_NO,SUM(T0.REVISED_QTY_DUE - T0.QTY_SHIPPED - T0.OPEN_SHIPMENT_QTY + T0.QTY_SHIPDIFF) as Demand_qty,T1.CF$_WEIGHT,
(SUM(T0.REVISED_QTY_DUE - T0.QTY_SHIPPED - T0.OPEN_SHIPMENT_QTY + T0.QTY_SHIPDIFF) * T1.CF$_WEIGHT) as Demand_Weight,
T2.On_Hand_Qty,(T2.On_Hand_Qty * T1.CF$_WEIGHT) as On_Hand_Weight,T1.PART_PRODUCT_CODE,T1.PART_PRODUCT_FAMILY,
T3.bucket_accum_cost
FROM CUSTOMER_ORDER_JOIN_CFV T0
INNER JOIN 
(SELECT PART_PRODUCT_CODE,PART_PRODUCT_FAMILY,PART_NO,CF$_WEIGHT
FROM Inventory_Part_Cfv 
GROUP BY PART_PRODUCT_CODE,PART_PRODUCT_FAMILY,PART_NO,CF$_WEIGHT)T1 ON T0.CATALOG_NO = T1.PART_NO
INNER JOIN 
(SELECT PART_NO,SUM(QTY_ONHAND)as On_Hand_Qty
FROM Inventory_Part_In_Stock_Cfv
WHERE CF$_C_TIRE_GRADE = 'A' AND QTY_ONHAND > 0
GROUP BY PART_NO)T2 ON T0.CATALOG_NO = T2.PART_NO
INNER JOIN
(SELECT part_no,bucket_accum_cost 
FROM PART_COST_BUCKET  
WHERE cost_set = '2' AND cost_bucket_id = '110')T3 ON T0.CATALOG_NO = T3.PART_NO


WHERE T0.state in ('Released','Partially Delivered') AND T0.CF$_BRAND = 'Globestar'
GROUP BY T0.CATALOG_NO,T1.CF$_WEIGHT,T2.On_Hand_Qty,T1.PART_PRODUCT_CODE,T1.PART_PRODUCT_FAMILY,T3.bucket_accum_cost